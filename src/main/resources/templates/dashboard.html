<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Admission Management CRM</title>

<style>
/* ===== Modern UI ===== */

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f4f6f9;
    margin: 0;
    padding: 20px;
}

h1 {
    text-align: center;
    color: #2c3e50;
}

.container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 25px;
}

.card {
    background: white;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.card h2 {
    margin-top: 0;
    color: #1976d2;
}

input, select, button {
    width: 100%;
    padding: 10px;
    margin-top: 10px;
    border-radius: 6px;
    border: 1px solid #ccc;
}

button {
    background: #1976d2;
    color: white;
    font-weight: bold;
    cursor: pointer;
    border: none;
}

button:hover {
    background: #125aa0;
}

.success {
    color: green;
    font-weight: bold;
    margin-top: 10px;
}

.stat {
    font-size: 18px;
    margin-top: 10px;
}
</style>
</head>

<body>

<h1>Admission Management & CRM</h1>

<div class="container">

    <!-- ✅ Create Applicant -->
    <div class="card">
        <h2>Create Applicant</h2>

        <input id="name" placeholder="Name">
        <input id="email" placeholder="Email">
        <input id="phone" placeholder="Phone">
        <input id="marks" placeholder="Marks">

        <select id="category">
            <option value="GM">GM</option>
            <option value="SC">SC</option>
            <option value="ST">ST</option>
        </select>

        <select id="entryType">
            <option value="Regular">Regular</option>
            <option value="Lateral">Lateral</option>
        </select>

        <button onclick="createApplicant()">Create Applicant</button>
        <div id="createMsg" class="success"></div>
    </div>

    <!-- ✅ Allocate Seat -->
    <div class="card">
        <h2>Allocate Seat</h2>

        <input id="allocApplicantId" placeholder="Applicant ID">
        <input id="programId" placeholder="Program ID">

        <select id="quotaType">
            <option value="KCET">KCET</option>
            <option value="COMEDK">COMEDK</option>
            <option value="MANAGEMENT">MANAGEMENT</option>
        </select>

        <button onclick="allocateSeat()">Allocate Seat</button>
        <div id="allocMsg" class="success"></div>
    </div>

    <!-- ✅ Confirm Admission -->
    <div class="card">
        <h2>Confirm Admission</h2>

        <input id="confirmId" placeholder="Applicant ID">

        <button onclick="confirmAdmission()">Confirm Admission</button>
        <div id="confirmMsg" class="success"></div>
    </div>

    <!-- ✅ Dashboard -->
    <div class="card">
        <h2>Dashboard</h2>

        <div class="stat">
            Total Applicants:
            <span th:text="${totalApplicants}">0</span>
        </div>
    </div>

</div>

<script>
const BASE = "";

// ✅ Create Applicant
async function createApplicant() {

    const data = {
        name: document.getElementById("name").value,
        email: document.getElementById("email").value,
        phone: document.getElementById("phone").value,
        marks: document.getElementById("marks").value,
        category: document.getElementById("category").value,
        entryType: document.getElementById("entryType").value
    };

    const res = await fetch("/saveApplicant", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify(data)
	});

    document.getElementById("createMsg").innerText =
        "Applicant Created Successfully";
}

// ✅ Allocate Seat
async function allocateSeat() {

    const applicantId = document.getElementById("allocApplicantId").value;
    const programId = document.getElementById("programId").value;
    const quotaType = document.getElementById("quotaType").value;

    const res = await fetch(
        `/allocateSeat?applicantId=${applicantId}&programId=${programId}&quotaType=${quotaType}`,
        { method: "POST" }
    );

    const text = await res.text();
    document.getElementById("allocMsg").innerText = text;
}

// ✅ Confirm Admission
async function confirmAdmission() {

    const applicantId = document.getElementById("confirmId").value;

    const res = await fetch(
        `/confirmAdmission?applicantId=${applicantId}`,
        { method: "POST" }
    );

    const text = await res.text();
    document.getElementById("confirmMsg").innerText = text;
}
</script>

</body>
</html>